Red Wine Quality by Jeswin George
========================================================

__Aim of this project__ is to find out which chemical property influence the 
quality of red wines.
                                                                                                                            
```{r echo=FALSE, message=FALSE, warning=FALSE, packages}
# Load all of the packages that you end up using in your analysis in this code
# chunk.

# Notice that the parameter "echo" was set to FALSE for this code chunk. This
# prevents the code from displaying in the knitted HTML output. You should set
# echo=FALSE for all code chunks in your file, unless it makes sense for your
# report to show the code that generated a particular plot.

# The other parameters for "message" and "warning" should also be set to FALSE
# for other code chunks once you have verified that each plot comes out as you
# want it to. This will clean up the flow of your report.

library(ggplot2)
library(tidyr)
library(dplyr)
library(GGally)
library(gridExtra)
library(corrplot)
library(lattice)
```

```{r echo=FALSE, Load_the_Data}
# Load the Data
wine_df <- read.csv('wineQualityReds.csv', header = TRUE, sep = ',')
```

# Univariate Plots Section

Size of dataset

```{r echo=FALSE, Univariate_Plots}
dim(wine_df)
```

The dataset consists of 13 variables and 1599 observations.

Structure of dataset

```{r echo=FALSE}
str(wine_df)
```

Converted the quality variable from type integer to type factor, as it denotes the ratings received by the wine.


Statistical summary of the given dataset

```{r echo=FALSE}
summary(wine_df)
```

### Analyzing variable : Quality

To check out the most frequent quality of wines available in the dataset.

```{r}
table(wine_df$quality)
```

The above stats shows the available number of different qualities of red wine 
present in the given dataset. The best quality of red wine available in the 
given dataset is ___Quality 8__  and it is totally 18 in number, Red wine with 
__Quality 7__ is 199 in number. And the most avaliable qualities of red wine are
__Quality 5__ and __QUality 6__ with 681 and 638 numbers respectively.

```{r echo=FALSE,fig.width=10}
ggplot(data = wine_df, aes(x=quality)) +
  geom_bar()+
  labs(x = 'Quality of wines', y = 'Frequency', title = 'Bargraph of frequency vs Quality of available wines')
```

So from the above two analysis: it is observed that wines with quality ratings 5 
and 6 is the most available in the given dataset. 

***

### Analyzing variable : fixed acidity

__Description of fixed acidity:__ most acids involved with wine or fixed or 
nonvolatile (do not evaporate readily).

```{r echo=FALSE,fig.width=10}
ggplot(data = wine_df, aes(x=fixed.acidity))+
  geom_histogram(binwidth = 0.5, color = 'black', fill = 'white')+
  scale_x_continuous(limits = c(4.5,16), breaks = seq(4.5,16,0.5))+
  labs(title = 'Histogram of fixed acidity')
```

The above distribution is right-skewed and most of the wines in the given 
dataset have fixed acidity between 6.5 and 8 g/dm^3^.

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=10}
ggplot(data = wine_df, aes(x=fixed.acidity))+
  geom_histogram(binwidth = 1, color = 'black', fill = 'white')+
  scale_x_continuous(limits = c(4.5,16), breaks = seq(4.5,16,1))+
  facet_wrap(  ~ quality, ncol=2, scales = 'free_y')+
  labs(title = 'Faceting the distribution of fixed.acidity based on wine quality')
```

The above facetted graph, confirms the previous two analysis that the red wines 
with __Quality 5 and 6__ are the most available in the dataset and their fixed 
acidity mostly ranges between 6.5 g/dm^3^ and 8 g/dm^3^ respectively. And the best
two  available qualities of wine __Quality 7 and 8__ have a very low count and 
their  value of fixed acidity usually varies between 6.5 and 11.5 g/dm^3^. 
Also __Quality 3 and 4__ wines have value of fixed acidity varying between 6,5 
and 8.5 g/dm^3^.


```{r echo=FALSE}
by(wine_df$fixed.acidity, wine_df$quality, summary)
```

The above statistics show the summary of fixed acidity present in different 
qualities of red wine.

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
ggplot(data = wine_df, aes(x=quality, y=fixed.acidity))+
  geom_boxplot(aes(group=quality))+
  coord_cartesian(ylim = c(6.5,10.5))+
  labs(title = 'Boxplot of fixed acidity vs Quality of red wine')
```

The __Quality 8__ of red wine has median fixed acidity  of 8.25 g/dm^3^ and mean
fixed acidity of 8.567 g/dm^3^. The __Quality 7__ of red wine has median fixed 
acidity of 8.8 g/dm^3^ and mean fixed acidity of 8.872 g/dm^3^.  

The most available __Quality 5__ of red wine has median fixed-acidity of 7.8 
g/dm^3^ and mean fixed-acidity of 8.167 g/dm^3^. And __Quality 6__ of red wine  
has median fixed-acidity of 7.9 g/dm^3^ and mean fixed-acidity of 8.347 g/dm^3^.

And the available poor qualities of red wine namely __Quality 3 and Quality 4__
have median fixed acidity of 7.5 g/dm^3^ each and their mean value of fixed 
acidity is 8.36 and 7.79 g/dm^3^ respectively.

So from the above anlaysis, fixed acidity volume does somewhat improve the 
quality of the condidered red wine.

***

### Analyzing variable : volatile acidity

__Description of volatile acidity:__ the amount of acetic acid in wine, which at
too high of levels can lead to an unpleasant, vinegar taste

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
ggplot(data = wine_df, aes(x=volatile.acidity))+
  geom_histogram(binwidth = 0.1, color = 'black', fill = 'white')+
  scale_x_continuous(limits = c(0,1.6), breaks = seq(0,1.6,0.1))+
  labs(title = 'Histogram of volatile acidity content in the available red wines')
```

From the above histogram of volatile acidity - most of the wines have volatile 
acidity in the range of 0.3 to 0.7 g/dm^3^.

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=10}
ggplot(data = wine_df, aes(x=volatile.acidity))+
  geom_histogram(binwidth = 0.1, color = 'black', fill = 'white')+
  scale_x_continuous(limits = c(0,1.6), breaks = seq(0,1.6,0.1))+
  facet_wrap(  ~ quality, ncol=2, scales = 'free_y')+
  labs(title = 'Faceting the distribution of volatile.acidity based on wine quality')
```

Most of the red wines with __Quality 8 and Quality 7__ have volatile acidity 
usually  ranging from 0.2 to 0.4 g/dm^3^. Also their distribution is 
right-skewed,so we can infer from this that good quality red wines have usually
low values of volatile acidity.

Red wines of __Quality 6 and 5__ are roughly normally distributed and their 
values usually range from 0.2 to 0.7 g/dm^3^.

Poor quality red wines of __Quality 3 and 4__ have their values ranging from
0.4 to 1 g/dm^3^.

```{r echo=FALSE}
by(wine_df$volatile.acidity, wine_df$quality, summary)
```

The above statistics show the summary of volatile acidity present in different 
qualities of red wine.

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
ggplot(data = wine_df, aes(x=quality, y = volatile.acidity))+
  geom_boxplot(aes(group=quality))+
  coord_cartesian(ylim = c(0.25,1.05))+
  labs(title = 'Boxplot of volatile acidity vs Quality of red wine')
```

The above box plot shows that good quality red wines have lower amounts of 
volatile acids present in them.

The best available red wine of __Quality 8 and Quality 7__ have median volatile 
acidity of 0.37 g/dm^3^ each and mean volatile acidity of 0.4233 and 0.4033 
g/dm^3^. And as the quality of red wine degrades amount of volatile acidity 
present in them also increases.

***

### Analyzing variable : Citric Acid

__Description of Citric acid:__  found in small quantities, citric acid can add 
'freshness' and flavor to wines.

```{r echo=FALSE,fig.width=10}
ggplot(data = wine_df, aes(x=citric.acid))+
  geom_histogram(binwidth = 0.05, color = 'black', fill = 'white')+
  scale_x_continuous(limits = c(0,1), breaks = seq(0,1,0.1))+
  labs(title = 'Histogram of Citric acid content in the available red wines')
```

The above histogram on amount of citric acid in the red wines is right-skewed.

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=10}
ggplot(data = wine_df, aes(x=citric.acid))+
  geom_histogram(binwidth = 0.05, color = 'black', fill = 'white')+
  scale_x_continuous(limits = c(0,1), breaks = seq(0,1,0.1))+
  facet_wrap(  ~ quality, ncol=2, scales = 'free_y')+
  labs(title = 'Faceting the distribution of citric acid based on wine quality')
```

The above faceted graph shows the amount of citric acid present in different 
qualities of red wine.  
Good red wines of __Quality 8 and 7__ have citric acid in the range 0.3 to 0.55 
g/dm^3^.  
Red wines of __Quality 6, 5 and 4__ have  roughly right skewed distribution and the
amount of citric acid in them range from 0 t0 0.6 g/dm^3^  and their values
usually lie around 0.35 to 0.6 g/dm^3^.   
Poor quality red wines of __Quality 3__ use citric acid in the range from 
0 to 0.6 g/dm^3^.

```{r echo=FALSE}
by(wine_df$citric.acid, wine_df$quality, summary)
```

The above statistics show the summary of citric acid present in different 
qualities of red wine.

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
ggplot(data = wine_df, aes(x=quality, y = citric.acid))+
  geom_boxplot(aes(group=quality))+
  coord_cartesian(ylim = c(0,0.55))+
  labs(title = 'Boxplot of citric acid vs Quality of red wine')
```

The above box plot shows that good quality red wines have higher amounts of 
citric acids present in them.

The best available red wine of __Quality 8 and Quality 7__ have median citric 
acid of 0.42 g/dm^3^ and 0.4 g/dm^3^ and mean volatile acidity of 0.3911 g/dm^3^
and 0.3752 g/dm^3^. And as the quality of red wine degrades amount of citric 
acid present in them also deceases.

***

### Analyzing variable : residual sugar

__Description of residual sugar:__ the amount of sugar remaining after 
fermentation stops, it is rare to find wines with less than 1 gram/liter and 
wines with greater than 45 grams/liter are considered sweet.

```{r echo=FALSE, fig.width=10,message=FALSE, warning=FALSE}
p <- ggplot(wine_df, aes(x=residual.sugar))+
  geom_histogram(binwidth = 0.5,color='black',fill='white')+
  scale_x_continuous(limits = c(0.5,16), breaks = seq(0.5,16,1))+
  labs(title = 'Histogram of residual sugar content in the available red wines')
  
p
```

The distribution obtained above is right-skewed distribution. And most of the 
available red wines have residual sugar in the range of 1.5 to 2.5 grams/liter. 
Applying log scale to the residual sugar histogram.

```{r echo=FALSE, fig.width=10,message=FALSE, warning=FALSE}
  ggplot(wine_df, aes(x=residual.sugar))+
  geom_histogram(binwidth = 0.1,color='black',fill='white')+
  labs(title = 'Histogram of residual sugar content using log_scale')+
  scale_x_log10(limits = c(0.8,16), breaks = seq(0.8,16,0.5))
```



```{r echo=FALSE, fig.width=10,message=FALSE, warning=FALSE}
ggplot(wine_df, aes(x=residual.sugar))+
  geom_histogram(binwidth = 0.1,color='black',fill='white')+
  scale_x_log10(limits = c(0.8,16), breaks = seq(0.8,16,0.5))+
  facet_wrap( ~ quality,ncol=2, scales = 'free_y')+
  labs(title = 'Faceting the distribution of residual sugar content based on wine quality in the available red wines')
```

The above diagram shows that almost all qualities of red wines use residual 
sugar in amounts between 1.5 to 2.5 grams/liter. And scarcely do the values of 
the residual sugar level varies. So chances are that the presence of residual 
sugar must be almost fixed in all red wines.

```{r echo=FALSE}
by(wine_df$residual.sugar, wine_df$quality,summary)
```

The above statistics show the summary of residual sugar present in different 
qualities of red wine.

```{r echo=FALSE, fig.width=10}
ggplot(wine_df, aes(x = quality, y = residual.sugar))+
  geom_boxplot(aes(group=quality))+
  coord_cartesian(ylim = c(1.5,3.3))+
  labs(title = 'Boxplot of amount of residual sugar level vs Quality of red wines')
```

The above graph using boxplots and the statistical summary above that proves 
that in almost all qualities of red wines the median quantity of residual sugar
ranges from 2.1 to 2.3 grams/liter. And the mean quantity of residual sugar is 
around  2.5 grams/liter.

***

### Analyzing variable : chlorides

__Description of chlorides:__ The amount of salt in the wine.

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
ggplot(wine_df, aes(x=chlorides))+
  geom_histogram(binwidth = 0.025,color = 'black', fill='white')+
  scale_x_continuous(limits = c(0,0.62), breaks = seq(0,0.62,0.05))+
  labs(title = 'Histogram of amount of chlorides in the available red wines')
```

The above histogram has a right skewed distribution. And it can be concluded 
from the distribution that the chlorides added to the red wines are in the range
of 0.05 to 0.1 grams.

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
ggplot(wine_df, aes(x=chlorides))+
  geom_histogram(binwidth = 0.025,color = 'black', fill='white')+
  scale_x_continuous(limits = c(0,0.62), breaks = seq(0,0.62,0.05))+
  facet_wrap( ~ quality, ncol=2, scales = 'free_y')+
  labs(title = 'Faceting the distribution of chlorides based on wine quality in the available red wines')
```

The above faceted graph shows almost all qualities of wine have their chlorides 
amount in the range of 0.05 to 1 grams. So it can be inferred that it is 
necessary to have chlorides in the abive mentioned range for the preapartaion of
the above wine.

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
by(wine_df$chlorides, wine_df$quality, summary)
```

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
ggplot(wine_df, aes(x=quality,y=chlorides))+
  geom_boxplot(aes(group=quality))+
  coord_cartesian(ylim = c(0.05,0.14))+
  labs(title='Boxplot of amount of chlorides vs the quality of red wine')
```

Using the boxplot and statistical summary it is seen that chlorides are used in 
small quanities of 0.05 to 0.15 grams. And the best available red wine of 
__quality 8__ uses the least median amount of 0.0705 grams and as the quality of
red wine decreases the chloride content increases along with it.   

So it can be assumed that the best quality of red wine has the least chloride
content in it.

***

### Analyzing variable : free.sulfur.dioxide

__Description of free.sulfur.dioxide:__ The free form of SO2 exists in 
equilibrium between molecular SO2 (as a dissolved gas) and bisulfite ion; it 
prevents microbial growth and the oxidation of wine

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
ggplot(wine_df, aes(x=free.sulfur.dioxide))+
  geom_histogram(binwidth = 1, color = 'black', fill='white')+
  scale_x_continuous(limits = c(1,72), breaks = seq(1,72,1))+
  labs(title = 'Histogram of free.sulfur.dioxide content in the available red wines')
```

The distribution of free.sulfur.dioxide content in the available red wines is 
right-skewed in nature and its mode value at 5.

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
ggplot(wine_df, aes(x=free.sulfur.dioxide))+
  geom_histogram(binwidth = 1, color = 'black', fill='white')+
  scale_x_continuous(limits = c(1,72), breaks = seq(1,72,1))+
  facet_wrap( ~ quality, ncol = 2, scales='free_y') +
  labs(title = 'Faceting the distribution of free.sulfur.dioxide based on wine quality')
```

The faceted distribution of free sulfur dioxide based on quality shows that 
majority of almost all qualities of wine use free sulifur dioxide in 5 ppm 
amounts.

```{r echo=FALSE, message=FALSE, warning=FALSE}
by(wine_df$free.sulfur.dioxide, wine_df$quality, summary)
```

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
ggplot(wine_df, aes(x=quality,y=free.sulfur.dioxide))+
  geom_boxplot(aes(group=quality))+
  coord_cartesian(ylim = c(0,25))+
  labs(title='Boxplot of amount of free.sulfur.dioxide vs the quality of red wine')
```

Using the boxplot and statistical summary it can be inferred that even though 
the presence of free sulfur dioxide is essential in red quality wines  to 
prevent the growth of microbes, its amount in the wine  does not have much 
affect on its quality.

***

### Analyzing variable : total.sulfur.dioxide

__Description of total.sulfur.dioxide:__ amount of free and bound forms of S0^2^
; in low concentrations, S0^2^ is mostly undetectable in wine, but at free S0^2^ 
concentrations over 50 ppm, S0^2^ becomes evident in the nose and taste of wine.

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
ggplot(wine_df, aes(x=total.sulfur.dioxide))+
  geom_histogram(binwidth = 10,fill='white',color='black')+
  scale_x_continuous(limits = c(0,300), breaks = seq(0,300,10))+
  labs(title = 'Histogram of distribution of sulfur.dioxide content in the available red wines')
```

The given histogram is right skewed in nature. And most of the available red 
quality wines have total sulfur dioxide of amount about 20 to 30 ppm.

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
ggplot(wine_df, aes(x=total.sulfur.dioxide))+
  geom_histogram(binwidth = 10,fill='white',color='black')+
  scale_x_continuous(limits = c(0,300), breaks = seq(0,300,10))+
  facet_wrap( ~ quality, ncol = 2, scales='free_y') +
  labs(title = 'Faceting the distribution of total.sulfur.dioxide based on wine quality')
```

The above faceted graph shows that majority of all qualities of wine have total 
sulfur dioxide in the of 20 to 30 ppm. And the histogram corresponding to each 
quality has a right-skewed distribution.

```{r echo=FALSE, message=FALSE, warning=FALSE}
by(wine_df$total.sulfur.dioxide, wine_df$quality,summary)
```

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
ggplot(wine_df, aes(x=quality,y=total.sulfur.dioxide))+
  geom_boxplot(aes(group=quality))+
  labs(title='Boxplot of amount of total.sulfur.dioxide vs the quality of red wine')+
  coord_cartesian(ylim = c(5,90))
```

From the statistical summary and boxplot it is seen that only __quality 5__ red
wines have the highest content of total sulfur dioxide with median value of 47 
ppm and mean value of 56.51 ppm. Also the best quality of available red wine 
which is __quality 8__ have low median content of total sulfur dioxide with 21.5
ppm and low mean content of total sulfur dioxide 33.44. And __quality 3__ which 
has low median content of 15 ppm and mean content of 24.9 ppm. So based on the 
amount of total sulfur dioxide available in each quality of wine we cannot 
decide whether quality of red wine is good or not.

***

### Analyzing variable : density

__Description of density:__ the density of water is close to that of water 
depending on the percent alcohol and sugar content.

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
ggplot(wine_df, aes(x=density))+
  geom_histogram(binwidth = 0.001, color = 'black', fill = 'white')+
  labs(title='Histogram of density of red wines')+
  scale_x_continuous(breaks = seq(0.990,1.004,0.001), limits = c(0.990,1.004) )
```

The above histogram on density of red wines has a normal distribution and most 
of the available red wines have a density in the range of 0.995 to 0.997. 

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
ggplot(wine_df, aes(x=density))+
  geom_histogram(binwidth = 0.001, color = 'black', fill = 'white')+
  labs(title='Faceting the distribution of density based on wine quality of the available red wines')+
  scale_x_continuous(breaks = seq(0.990,1.004,0.001), limits = c(0.990,1.004))+
  facet_wrap( ~ quality, ncol=2, scales = 'free_y')
```

The faceted distribution shows that almost all qaulity of red wines have a 
normal distribution with their mean value of density concentrated around the 
0.994 to 0.996 region of density for __quality 7 and quality 8__ red wines. And 
the other lower quality wines had their majority of the density values ranging 
from 0.995 to 0.997.

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
by(wine_df$density, wine_df$quality, summary)
```

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
ggplot(wine_df, aes(x=quality, y=density))+
  geom_boxplot(aes(group=quality))+
  labs(title='Boxplot of density vs quality of red wine')+
  coord_cartesian(ylim = c(0.994,0.999))
```

From the statistical summary and boxplot it can be seen that good quality red 
wines having __quality 8 and 7__ have a low median value of density 0.9949 and 
0.9958 respectively, and mean density value of 0.9952 and 0.9961. For other 
lower qualities of wine such as __quality 3__ has median density value of 0.9976
and mean density value of 0.9975. So it can be said that lower density of red 
wines denotes better quality. 

***

### Analyzing variable : pH

__Description of pH:__ describes how acidic or basic a wine is on a scale from 0
(very acidic) to 14 (very basic); most wines are between 3-4 on the pH scale.

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
ggplot(wine_df, aes(x=pH))+
  geom_histogram(binwidth = 0.1, color = 'black', fill = 'white')+
  scale_x_continuous(limits = c(2.73, 4.02), breaks = seq(2.74,4.02,0.1))+
  labs(title = 'Histogram of pH values of red wine')
```

The above histogram has a normal distribution and most of the red wines have pH 
values in the range of 3.14 to 3.44.

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
ggplot(wine_df, aes(x=pH))+
  geom_histogram(binwidth = 0.1, color = 'black', fill = 'white')+
  scale_x_continuous(limits = c(2.73, 4.02), breaks = seq(2.74,4.02,0.1))+
  labs(title = 'Faceting the distribution of pH values based on wine quality in the available red wines')+
  facet_wrap( ~ quality, ncol=2, scales = 'free_y')
```

From the above faceted graph it can be seen that __quality 5 to 8__ have normal 
distribution and their values range from 3.14 to 3.44. The graph of distribution
of pH values for different qualities of red wine are not much helpful in finding
how pH values affect quality.

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
by(wine_df$pH, wine_df$quality,summary)
```

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
ggplot(wine_df, aes(x=quality,y=pH))+
  geom_boxplot(aes(group=quality))+
  labs(title = 'Boxplot of pH vs Quality for red wine')+
  coord_cartesian(ylim = c(3.15,3.55))
```

From the statistical summary and boxplot it is observed that median pH value of 
__quality 8__ red wine is 3.23 and it is lower than other qualities of red wine 
but its mean pH value is 3.267 which is higher than the mean pH values of other 
quality of wines. So it cannot be generally stated that pH has a direct 
relationship with the quality of wine.

***

### Analyzing variable : sulphates

__Description of sulphates:__ a wine additive which can contribute to sulfur 
dioxide gas (S02) levels, wich acts as an antimicrobial and antioxidant.

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
ggplot(wine_df, aes(x=sulphates))+
  geom_histogram(binwidth = 0.1, color = 'black', fill = 'white')+
  scale_x_continuous(limits = c(0.3,2), breaks = seq(0.3,2,0.1))+
  labs(title = 'Histogram of distribution of sulphates for red wines')
```

The distribution of sulphates in red wine has a right-skewed distribution with 
the mode value of sulphates lying in the range from 0.5 to 0.6.


```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
ggplot(wine_df, aes(x=sulphates))+
  geom_histogram(binwidth = 0.1, color = 'black', fill = 'white')+
  scale_x_continuous(limits = c(0.3,2), breaks = seq(0.3,2,0.1))+
  labs(title = 'Faceting the distribution of sulphates based on wine quality in the available red wines')+
  facet_wrap( ~ quality, ncol = 2, scales = 'free_y')
```

From the faceted distribution of sulphates considering quality as the 
categorical variable it is seen that that the amount of sulphates in higher 
quality of wines such as __quality 8 and 7__ have slightly higher higher amount 
of sulphates than those ranging from quality 3 to quality 6.


```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
by(wine_df$sulphates, wine_df$quality,summary)
```

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
ggplot(wine_df, aes(x=quality,y=sulphates))+
  geom_boxplot(aes(group=quality))+
  labs(title='Boxplot of amount of sulphates vs Quality for red wine')+
  coord_cartesian(ylim = c(0.48,0.84))
```

From the statistical summary and boxplot of sulphates vs the quality of red 
wines it is observed that better quality red wines such as __quality 8 and 7__ 
have higher median amd mean value of sulphates as compared to that of other 
lower quality red wines.

***

### Analyzing variable : alcohol

__Description of alcohol:__ the percent alcohol content of the wine measured in 
% by volume.

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
ggplot(wine_df, aes(x=alcohol))+
  geom_histogram(binwidth = 0.5,color='black',fill='white')+
  labs(title = 'Histogram of distribution of alcohol in red wines')+
  scale_x_continuous(limits = c(8,15), breaks = seq(8,15,0.5))
```

The alcohol content in red wines have a right-skewed distribution with most of 
the red wines having alcohol content in range from 9-10 % by volume.


```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
ggplot(wine_df, aes(x=alcohol))+
  geom_histogram(binwidth = 0.5,color='black',fill='white')+
  labs(title = 'Faceting the distribution of alcohol based on wine quality in the available red wines')+
  scale_x_continuous(limits = c(8,15), breaks = seq(8,15,0.5))+
  facet_wrap( ~quality, ncol=2, scales = 'free_y')
```

From the faceted distribution of alcohol based on quality it can be observed 
that usually good quality red wines having quality ratings of 
__quality 8 and 7__ have higher alcohol content than other quality of available 
red wines.

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
by(wine_df$alcohol, wine_df$quality, summary)
```

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
ggplot(wine_df, aes(x=quality,y=alcohol))+
  geom_boxplot(aes(group=quality))+
  labs(title='Boxplot of alcohol content vs quality of red wine')+
  coord_cartesian(ylim = c(9.2,13))
```

From the statistical summary and boxplot above it can be assumed that high 
quality of red wines have higher alcohol content % by volume as compared to 
other lower quality wines.

***

### Analyzing created variable : Total_acidity

__Description of Total_acidity :__ As there are three types of acidity in the 
red wine so i was just curious to find out the net effect of all acidity on the 
quality of red wine.

So i created a new variable called __Total_acidity__ (measured in g/dm^3^) which
is the sum of fixed  acidity, volatile acidity and citirc acid. 

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
wine_df <- wine_df %>%
  mutate(Total_acidity = fixed.acidity + citric.acid + volatile.acidity)

ggplot(wine_df, aes(x=Total_acidity))+
  geom_histogram(binwidth = 0.5, color='black', fill='white')+
  scale_x_continuous(limits=c(5,17.5), breaks = seq(5,17.5,0.5))+
  labs(title='Histogram of distribution of total_acidity in red wines')
```

The above histogram has a right-skewed distribution with majority of the red 
wines having total acidity in the range of 7.5 to 9 g/dm^3^.

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
ggplot(wine_df, aes(x=Total_acidity))+
  geom_histogram(binwidth = 0.5, color='black', fill='white')+
  scale_x_continuous(limits=c(5,17.5), breaks = seq(5,17.5,0.5))+
  labs(title='Faceting the distribution of total_acidity in red wines based on quality')+
  facet_wrap( ~quality, ncol=2, scales = 'free_y')
```

The faceted graph shows the distribution of total acidity in the available red 
wine for different qualities.Quality 6 and 5 have a right-skewed distribution. 
And the distibution for better qualilty 7 and 8 have uneven distribution.

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
by(wine_df$Total_acidity, wine_df$quality,summary)
```

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
ggplot(wine_df, aes(x=quality, y=Total_acidity))+
  geom_boxplot(aes(group=quality))+
  labs(title='Boxplot of total acidity vs quality of red wine')+
  coord_cartesian(ylim = c(7.5,11))
```

The statistical summary and boxplot of total acidity with respect to quality 
does not show any type of relation between them.

***

### Analyzing created variable : prop_free_so2

__Description of prop_free_so2 :__ It is the ratio of free.sulfur.dioxide to 
total.sulfur.dioxide present in the concerned red wine. As the 
total.sulfur.dioxide present in the red wine contains both free.sulfur.dioxide 
and bound.sulfur.dioxide so to determine the proportion in which the 
free.sulfur.dioxide is used and to check how this ratio affect the quality of 
red wine we use this variable.

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
wine_df <- wine_df %>%
  mutate(prop_free_so2 = free.sulfur.dioxide/total.sulfur.dioxide)

ggplot(wine_df, aes(x=prop_free_so2))+
  geom_histogram(binwidth = 0.1, color='black',fill='white')+
  labs(title='Histogram of distribution of proportion of free SO2 in red wine')+
  scale_x_continuous(limits = c(0,1), breaks = seq(0,1,0.1))
```

The above histogram shows distribution of proportion of free SO^2^ in the red 
wine and most of the red wines have the proportion usually between 0.1 to 0.5.  

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
ggplot(wine_df, aes(x=prop_free_so2))+
  geom_histogram(binwidth = 0.1, color='black',fill='white')+
  labs(title='Faceting the distribution of proportion of free SO2 in red wine based on quality')+
  scale_x_continuous(limits = c(0,1), breaks = seq(0,1,0.1))+
  facet_wrap( ~ quality, ncol=2, scales = 'free_y')
```

The above faceted distribution shows distribution of proportion of free SO^2^ in
various qualities of red wine.

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
by(wine_df$prop_free_so2, wine_df$quality,summary)
```

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
ggplot(wine_df, aes(x=quality, y=prop_free_so2))+
  geom_boxplot(aes(group=quality))+
  coord_cartesian(ylim = c(0.2,0.6))+
  labs(title='Boxplot of free sulfur dioxide to the quality of red wine')
```

The statistical summary and boxplot gives the median and mean value of 
proportion of free SO^2^ with respect to total sulfur dioxide. 

# Univariate Analysis

### What is the structure of your dataset?

The above dataset consists of 1599 observations and 15 variables.    
Also i added 2 variables to the dataset namely Total_acidity and prop_free_SO2.

### What is/are the main feature(s) of interest in your dataset?

* In the given dataset, 6 qualities of datset are available namely 
_QUality 3, QUality 4, QUality 5, QUality 6, QUality 7 and QUality 8_.

* Of the available qualities of red wines _quality 5_ and _quality 6_ are the 
majority 681 and 638 respectively.

### What other features in the dataset do you think will help support your \
investigation into your feature(s) of interest?

The following analysis made in the above univariate analysis might help in 
determining the chemical property which help in influencing the quality of red
wines-

* Good quality red wines have lower amounts of volatile acids present in them.
* Citric acid content is higher in good quality wines.
* Amount of residual sugar content is almost same across all qualities of red 
wine.
* Good quality of red wines have lower density.
* Sulphate content is higher in good quality red wines.
* Alcohol content is higher in good quality red wines.

### Did you create any new variables from existing variables in the dataset?

Yes, i created 2 new variables from the existing variables.

* __Total_acidity :__ As there are three types of acidity in the 
red wine so i was just curious to find out the net effect of all acidity on the 
quality of red wine. So i created this variable which is the sum of fixed  
acidity, volatile acidity and citirc acid. (measured in g/dm^3^)

* __prop_free_so2 :__ It is the ratio of free.sulfur.dioxide to 
total.sulfur.dioxide present in the concerned red wine. As the 
total.sulfur.dioxide present in the red wine contains both free.sulfur.dioxide 
and bound.sulfur.dioxide so to determine the proportion in which the 
free.sulfur.dioxide is used and to check how this ratio affect the quality of 
red wine we use this variable.

### Of the features you investigated, were there any unusual distributions? \
Did you perform any operations on the data to tidy, adjust, or change the form \
of the data? If so, why did you do this?

I tried to change the scale of  x-axis from continuous to logarithmic but there 
was not much variation to the plot. No other transformation to the dataset and
plot was required as 


# Bivariate Plots Section

In the bivariate analysis, i will start by finding the correlation coefficent 
between quality and other variables and among the other supporting variables. 

__Correlation matrix__

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=8, fig.height=7}
cwine_df <- wine_df %>%
  select(c(2:15))

mcor <- cor(cwine_df)
round(mcor,digits = 3)  
```

__Plotting the Correlation matrix__

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
corrplot(mcor)
```

From the correlation matrix plot it can be observed that :

* Fixed acidity is highly correlated citric acid, density and Total 
acidity.  Fixed acidity has high value of negative correlation with pH. And 
correlation of fixed acidity with quality is very low. 
* Volatile acidity is negatively correlated with citric acid and quality.
* Citric acid has high positive correlation with fixed acidity and total acidity.
* Density has highly positively correlated with fixed acidity and total acidity.
* pH has negative correlation with density, fixed, citric and total acidity.
* Alcohol has negative correlation with density and positive correlation with 
alcohol.  

__Scatterplot matrix__

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10, fig.height=10}
splom(cwine_df[c(1,2,7,8,9,11,12)], data = cwine_df, groups = NULL,  axis.line.tck=0,axis.text.alpha = 0)
```

The above scatter plot matrix has been made by selecting the variables from the
correlation matrix plot. This graph helps in getting the idea of scatterplot 
that we will get when plotting different variables in the datset,

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
ggplot(wine_df, aes(x=pH, y=fixed.acidity))+
  geom_point(color='grey60')+
  stat_smooth(color='red',method='lm')+
  labs(title='Scatterplot of Fixed-acidity vs pH of red wine',y='fixed acidity (tartaric acid-g/dm^3)')
```

The above graph shows the negative correlation between fixed acidity and pH 
value of red wine. Also a linear regression line is added to a scatterplot.

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
ggplot(wine_df, aes(x=pH, y=density))+
  geom_point(color='grey60')+
  stat_smooth(color='red')+
  labs(title='Scatterplot of density vs pH of red wine',y='density (g/cm^3)')
```

The above graph shows the scatterplot between density and pH of red wine it 
shows the negative corelation between density and pH. Also the regression line 
used here is a loess curve.

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
ggplot(wine_df,aes(y=density,x=alcohol))+
  geom_point(color='grey60')+
  stat_smooth(method = 'loess',color='red', linetype='solid')+
  labs(title='Scatterplot of density vs alcohol content in red wine', 
       x = 'alcohol (% by volume)', y='density (g/cm^3)')
```

The above graph shows scatterplot of density vs alcohol content in red wine. 
These parameters are negatively correlated and the negative correlation is shown
using a loess curve.

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
ggplot(wine_df,aes(x=quality, y = alcohol))+
  geom_point(alpha=1/5,color='grey60')+
  geom_line(stat = 'summary', fun.y = mean, color='blue') +
  geom_line(stat = 'summary', fun.y = median, color = 'red') +
  labs(title='Scatterplot of Quality vs alcohol content of red wine', 
       y = 'alcohol (% by volume)')
```

The above scatterplot has quality as discrete variable and for higher quality of
red wine the alcohol content is also high which also proves the positive 
correlation between them. The blue line denotes the mean value of alcohol 
content across each quality. The red line denotes the median value of alcohol 
content across each quality.

In the univariate analysis, boxplot graph was shown to prove the relation 
between quality and alcohol content in red wine.

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
ggplot(wine_df, aes(x=quality, y=volatile.acidity))+
  geom_point(alpha=1/2,color='grey60')+
  geom_line(stat = 'summary', fun.y = mean,color='blue') +
  geom_line(stat = 'summary', fun.y = median, color='red') +
  labs(title='Scatterplot of Quality vs volatile acidity of red wine',
       y='volatile acidity (acetic acid - g/dm^3)')
```

The above scatterplot has quality as discrete variable and for higher quality of
red wine the volatile acidity is very low which also proves the negative 
correlation between them. The blue line denotes the mean value of volatile 
acidity across each quality. The red line denotes the median value of volatile 
acidity across each quality.

In the univariate analysis, boxplot graph was shown to prove the relation 
between quality and volatile acidity in red wine.

# Bivariate Analysis

### Talk about some of the relationships you observed in this part of the \
investigation. How did the feature(s) of interest vary with other features in \
the dataset?

The bivarite analysis, gave an insight into the correlation  between quality and
other variables with the help of correlation coefficient and scatterplot. It was
observed that quality of red wine improves with the decreases in volatile 
acidity. The alcohol content in red wine also improves the wine quality. From 
the correlation matrix it was also observed that residual sugar and other 
parameters don't have much effect on the quality of red wine.

### Did you observe any interesting relationships between the other features \
(not the main feature(s) of interest)?

The relationship between pH and fixed/total acidity they have negative 
correlation i.e., as pH value increases acidity content decreases. Also, pH is 
negatively correlated with the density of the red wine. And density of the red
wine is also having negative correlation with the alcohol content in the red 
wine. It is also found that citric acid is positively correlated with fixed 
acidity of red wine but has a negative correlation with volatile acidity.

The bivariate analysis helped in improving the insight into the relationship 
between quality and variables such as residual sugar,density and citric acid. It 
was found that the presence of these variables don't have much impact on the 
quality of red wines.

### What was the strongest relationship you found?

The quality of red wine is highly dependant on volatile acidity and alcohol 
content of the red wine. The quality and volatile acidity has  negative 
correlation. The quality and alcohol content has a positive correlation between 
them. 


# Multivariate Plots Section


```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
wine_df$quality <- ordered(wine_df$quality, levels=c(1:10))
ggplot(data = wine_df,aes(y=density, x=alcohol,color=quality))+
  geom_point(size=5)+
  scale_color_brewer(type='div', guide = guide_legend(title = 'Quality'))+
  ggtitle('Alcohol and density of red wine based on Quality')+
  labs(x = 'Alcohol (% by volume)',y='density (g/cm^3)')
```

Analyzing the 



```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
ggplot(data = wine_df,aes(y=pH, x=alcohol,color=quality))+
  geom_point(size=5)+
  scale_color_brewer(type='seq', guide = guide_legend(title = 'Quality'))+
  ggtitle('pH and alcohol of red wine based on Quality')+
  labs(x = 'Alcohol (% by volume)')
```

From the 

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
ggplot(data = wine_df,aes(x=pH, y=fixed.acidity,color=quality))+
  geom_point(size=5)+
  scale_color_brewer(type='seq', guide = guide_legend(title = 'Quality'))+
  ggtitle('pH and fixed acidity of red wine based on Quality')+
  labs(y='fixed acidity (tartaric acid - g/dm^3)')
```



```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
ggplot(wine_df, aes(x=alcohol,y=volatile.acidity,color=quality))+
  geom_point(size=4)+
  scale_color_brewer(type='div', guide = guide_legend(title = 'Quality'))+
  ggtitle('volatile acidity vs alcohol content of red wine based on quality')+
  labs(x = 'Alcohol (% by volume)', y = 'volatile acidity (acetic acid - g/dm^3)')
```





# Multivariate Analysis

### Talk about some of the relationships you observed in this part of the \
investigation. Were there features that strengthened each other in terms of \
looking at your feature(s) of interest?

### Were there any interesting or surprising interactions between features?

### OPTIONAL: Did you create any models with your dataset? Discuss the \
strengths and limitations of your model.

------

# Final Plots and Summary

> **Tip**: You've done a lot of exploration and have built up an understanding
of the structure of and relationships between the variables in your dataset.
Here, you will select three plots from all of your previous exploration to
present here as a summary of some of your most interesting findings. Make sure
that you have refined your selected plots for good titling, axis labels (with
units), and good aesthetic choices (e.g. color, transparency). After each plot,
make sure you justify why you chose each plot by describing what it shows.

### Plot One
```{r echo=FALSE,fig.width=10}
ggplot(data = wine_df, aes(x=quality)) +
  geom_bar()+
  labs(x = 'Quality of wines', y = 'Frequency', title = 'Bargraph of frequency vs Quality of available wines')
```

### Description One


### Plot Two
__Plotting the Correlation matrix__
```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
corrplot(mcor)
```

### Description Two


### Plot Three
```{r echo=FALSE, message=FALSE, warning=FALSE,fig.width=10}
ggplot(wine_df, aes(x=alcohol,y=volatile.acidity,color=quality))+
  geom_point(size=4)+
  scale_color_brewer(type='div', guide = guide_legend(title = 'Quality'))+
  ggtitle('volatile acidity vs alcohol content of red wine based on quality')+
  labs(x = 'Alcohol (% by volume)', y = 'volatile acidity (acetic acid - g/dm^3)')
```

### Description Three

------

# Reflection

> **Tip**: Here's the final step! Reflect on the exploration you performed and
the insights you found. What were some of the struggles that you went through?
What went well? What was surprising? Make sure you include an insight into
future work that could be done with the dataset.

> **Tip**: Don't forget to remove this, and the other **Tip** sections before
saving your final work and knitting the final report!